# 키친포스

## How to run

```sh
cd docker
docker compose -p kitchenpos up -d
```

## 요구 사항

- 메뉴 애그리거트과 주문 애그리거트으로 구분 될 수 있습니다.

## Menu Aggregate

### MenuGroup

- **메뉴 그룹**는 하나 이상의 **메뉴**로 구성될 수 있습니다.
- **메뉴 그룹**은 각각 고유한 걔념을 가질 수 있습니다.
    - 고유한 걔념은 속한 **메뉴**들의 개성을 설명합니다.
    - ex. `추천메뉴` ,`순살메뉴` ,`한마리메뉴` ,`신메뉴` ,`두마리메뉴`
- **메뉴 그룹**은 `식별자` 와 `이름`으로 구성됩니다.
    - `식별자`는 중복되지 않은 랜덤한 값으로 부여됩니다.
    - `이름`은 중복되지 않는 고유한 값이어야 합니다.
    - `이름`은 비속어를 포함하지 않아야 합니다.
- **메뉴 그룹**은 새로 등록 될 수 있습니다.
    - 등록 시 `식별자`는 자동으로 부여됩니다.
    - 등록 시 중복되지 않는 `이름`을 등록해야합니다.
    - `이름`은 비속어를 포함하지 않아야 합니다.
- **메뉴 그룹**을 조회할 수 있습니다.

### Product

- **메뉴**는 하나 이상의 **상품**으로 구성될 수 있습니다.
    - 예를 들어 `후라이드 치킨 세트` **메뉴**에는 `후라이드 치킨`과 `콜라`가 포함될 수 있습니다.
    - 여기서 `후라이드 치킨`과 `콜라`는 각각 **상품**입니다.
- **상품**의 상품은 `식별자, 이름, 가격`으로 구성됩니다.
    - `식별자`는 중복되지 않은 랜덤한 값으로 부여됩니다.
    - `이름`은 중복되지 않는 고유한 값이어야 합니다.
    - `이름`은 비속어를 포함하지 않아야 합니다.
    - `가격`은 0보다 큰 값이어야 합니다.
- **상품**은 새로 등록 될 수 있습니다.
    - 등록 시 `식별자`는 자동으로 부여됩니다.
    - 등록 시 비속어가 아닌 중복되지 않는 `이름`을 필수적으로 등록해야합니다.
    - 등록 시 0 이상의 `가격`을 필수적으로 등록해야합니다.
- **상품**의 가격을 수정할 수 있습니다.
    - 상품의 가격은 0보다 큰 값이어야 합니다.
- **상품**을 조회할 수 있습니다.

### Menu Product

- **메뉴 상품**은 **상품**이 **메뉴**에 어떻게 구성되어 있는지를 나타냅니다..
    - 예를 들어 `후라이드 치킨 세트` **메뉴**에는 `후라이드 치킨`과 `콜라`  **상품**이 각각 1개씩 포함될 수 있습니다.
    - 혹은 `양념 두마리 치킨 세트` **메뉴**에는 `양념 치킨`이 2마리가 포함될 수 있습니다.
- **메뉴 상품**은 메뉴 등록 시 하나 이상 등록이 필요합니다
- **메뉴 상품**은 `식별자`,`수량`,`상품식별자`,`메뉴식별자`로 구성됩니다.
    - `식별자`는 메뉴와 함께 등록시 자동으로 부여되는 값입니다.
    - `수량`은 1 이상의 값이어야 합니다.
    - `상품식별자`는 상품의 식별자입니다. **상품**의 식별자와 연결됩니다.
    - `메뉴식별자`는 메뉴의 식별자입니다. **메뉴** 식별자와 연결됩니다.

### Menu

- **주문**은 하나 이상의 **메뉴**로 구성될 수 있습니다.
- 하나의 **메뉴** 안에 여러 **상품**이 포함될 수 있습니다.
    - **메뉴**는 **메뉴 상품**을 통해 구성 메뉴를 파악할 수 있습니다.
- **메뉴** 는 `식별자, 화면표시여부, 이름, 가격, 메뉴그룹식별자`로 구성됩니다.
    - `식별자`는 중복되지 않은 랜덤한 값으로 부여됩니다.
    - `화면표시여부`는 메뉴가 화면에 표시되는지 여부를 나타냅니다.
    - `이름`은 중복되지 않는 고유한 값이어야 합니다.
    - `이름`은 비속어를 포함하지 않아야 합니다.
    - `가격`은 0보다 큰 값이어야 합니다.
    - `가격`은 최소 0.01원부터 최대 9999999999999999999.99원까지 표현할 수 있습니다.
    - `메뉴그룹식별자`는 어느 메뉴그룹에 속하는지 확인하는 값입니다. **메뉴 그룹**의 식별자와 연결됩니다.
- **메뉴**는 새로 등록 될 수 있습니다.
    - 등록 시 `식별자`는 자동으로 부여됩니다.
    - 등록 시 중복되지 않는 `이름`을 등록해야합니다.
    - 등록 시 0 이상의 `가격`을 등록해야합니다.
    - 등록 시 `메뉴그룹식별자`는 메뉴 그룹의 식별자와 연결되어야합니다.
    - 등록 시 하나 이상의 `메뉴상품`을 함께 등록해야합니다.
- **메뉴**의 가격을 수정할 수 있습니다.
    - 수정 시 `가격`은 필수입니다.
    - 메뉴의 가격은 0보다 큰 값이어야 합니다.
- **메뉴**를 화면에 표시할 수 있습니다.
- **메뉴**를 화면에서 숨길 수 있습니다.
- **메뉴**를 조회할 수 있습니다.

## Order Aggregate

### Order

- 고객은 주문을 생성할 수 있습니다.
- 주문은 하나 이상의 주문항목으로 구성됩니다.
- 고객은  **DELIVERY(배달)**, **TAKEOUT(포장)**, **EAT_IN(매장식사)** 중 하나를 선택해 주문 할 수 있습니다.
- 고객은 **DELIVERY(배달)** 타입의 주문시 배달 주소를 제공해야한다.
- 고객은 **EAT_IN(매장식사)** 타입의 주문시 테이블을 선택해야한다.
- `POST /api/orders` 요청을 통해 주문을 생성할 수 있습니다.
    - `id`, `delivery_address`, `order_date_time`, `status`, `type`, `order_table_id` 필드로 구성되어있습니다.
    - `id`는 uuid로 부여/식별됩니다.
    - `delivery_address` 필드는 **DELIVERY(배달)** 주문 타입일 때 필수입니다. **TAKEOUT(포장)**, **EAT_IN(매장식사)** 주문 타입일 때는 무시됩니다.
    - `order_date_time` 필드는 주문 생성 시간입니다.
    - `status` 필드는 주문 상태입니다.   **WAITING**, **ACCEPTED**, **SERVED**, **DELIVERING**, **DELIVERED**, **COMPLETED** 중
      하나입니다.
        - 최초 생성 시 `status` 필드는 **WAITING**으로 설정됩니다.
    - `type` 필드는 주문 타입입니다. **DELIVERY(배달)**, **TAKEOUT(포장)**, **EAT_IN(매장식사)** 중 하나입니다.
    - `order_table_id` 필드는 **EAT_IN(매장식사)** 주문 타입일 때 필수입니다. **DELIVERY(배달)**, **TAKEOUT(포장)** 주문 타입일 때는 무시됩니다.
    - 요청 시 하나 이상의 `order_line_items`를 함께 등록해야합니다. `order_line_items` 상세한 내용은 아래에 설명합니다.
- 하위 요청을 통해 주문의 상태를 변경할 수 있습니다.
    - `PUT /api/orders/${orderId}/accept` : 주문을 접수합니다.
    - `PUT /api/orders/${orderId}/serve` : 주문을 제공합니다.
    - `PUT /api/orders/${orderId}/start-delivery` : 배달을 시작합니다.
    - `PUT /api/orders/${orderId}/complete-delivery` : 배달을 완료합니다.
    - `PUT /api/orders/${orderId}/complete` : 주문을 완료합니다.
    - `${orderId}` 는 주문의 아이디를 의미합니다.
- `GET /api/orders` 요청을 통해 주문 목록을 조회할 수 있습니다

### OrderLineItem

- 메뉴와 주문은 다대다 관계입니다.
- 하나의 메뉴가 여러 주문에 포함될 수 있습니다.
    - 이런 복잡성을 해소하기 위해 `order_line_item` 테이블을 사용합니다.
    - `order` 와 `order_line_item`와 1:N 관계를 가집니다.
    - `menu` 와 `order_line_item`와 1:N 관계를 가집니다.
- 주문 항목은 주문 등록(`POST /api/orders`) 시 필수적으로 하나 이상 포함되어야 합니다.
    - `seq`, `quantity`, `menu_id`, `order_id` 필드로 구성되어있습니다.
    - `seq`는 자동 증가되는 값입니다.
    - `seq`를 제외한 나머지 필드는 필수입니다.
    - `quantity` 는 주문하는 메뉴의 수량을 의미합니다.
    - `quantity` 1 이상의 값이어야 합니다.
    - `menu_id`는 메뉴의 아이디입니다. menu 테이블의 아이디와 연결됩니다.
    - `order_id`는 주문의 아이디입니다. order 테이블의 아이디와 연결됩니다.

### OrderTable

- 테이블은 매장의 좌석수를 의미합니다.
- 주문 생성 시 타입이 **EAT_IN(매장식사)**  일 경우 해당 테이블의 Id를 참조 해야합니다.
- 만약 모든 좌석이 사용 중일 경우 **EAT_IN(매장식사)** 타입의 주문을 생성할 수 없습니다.
- `POST /api/order-tables` 요청을 통해 테이블을 등록할 수 있습니다.
    - `id`, `name`, `number_of_guests`, `empty` 필드로 구성되어있습니다.
    - `id`는 uuid로 부여/식별됩니다.
    - `name` 필드는 필수입니다.
    - `name` 필드는 고유한 값이어야 합니다.
    - `number_of_guests` 필드는 테이블의 좌석수를 의미합니다.
    - `occupied` 필드는 비트 타입으로 테이블의 사용 여부를 나타냅니다.
- `PUT /api/order-tables/${orderTableId}/sit` 요청을 통해 테이블을 사용 중으로 변경할 수 있습니다.
- `PUT /api/order-tables/${orderTableId}/clear` 요청을 통해 테이블을 사용 가능으로 변경할 수 있습니다.
- `PUT /api/order-tables/${orderTableId}/number-of-guests` 요청을 통해 테이블의 좌석수를 변경할 수 있습니다.
    - `number_of_guests` 필드는 필수입니다.
    - `number_of_guests` 필드는 0보다 큰 값이어야 합니다.
- `GET /api/order-tables` 요청을 통해 테이블 목록을 조회할 수 있습니다.

### 모델링 참고

![](https://i.imgur.com/Jf6exQt.png)
